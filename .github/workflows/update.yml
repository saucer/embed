on:
  workflow_dispatch:
    inputs:
      source:
        type: string
        required: true
        default: "https://raw.githubusercontent.com/jshttp/mime-db/refs/heads/master/db.json"

name: ğŸ¤– Update
jobs:
  update:
    runs-on: ubuntu-latest 
    container: archlinux:base-devel
    name: "Update (ğŸ“„: ${{ github.event.inputs.source }})"

    steps:
      - name: ğŸ“¦ Checkout
        uses: actions/checkout@v4

      - name: ğŸ§° Dependencies
        run: pacman --noconfirm -Syu git cmake gcc ninja make wget

      - name: ğŸ”§ Compile
        run: |
          cmake -B build -Dembed_parser=ON
          cmake --build build 

      - name: ğŸš§ Update 
        run: |
          wget "${{ github.event.inputs.source }}" input.json
          ./build/embed input.json > data/mimes.txt
      
      - name: ğŸ™ Commit & Push
        uses: EndBug/add-and-commit@v9 
        with:
          default_author: github_actions
          message: "feat(data): update database"
